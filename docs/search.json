[{"path":"https://github.com/vjcitn/BiocAnnoParq/articles/BiocAnnoParq.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"BiocAnnoParq: SQL-based interrogation of Bioconductor's curated genomic annotation","text":"Bioconductor’s annotation curation pipelines products 17 year history supporting many aspects data analysis genome-scale biology. AnnotationDbi package defines three basic types annotation: Gene centric (subclasses organism, platform, system) Genome centric (e.g., transcript catalogs) Service client (e.g., biomart)","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/articles/BiocAnnoParq.html","id":"annotationdbi-based-queries","dir":"Articles","previous_headings":"Introduction","what":"AnnotationDbi-based queries","title":"BiocAnnoParq: SQL-based interrogation of Bioconductor's curated genomic annotation","text":"’s illustration usage current methodology interrogating Bioconductor annotation. consider retrieve Gene Ontology categories gene ORMDL3 evidence code TAS (traceable author statement). example involves two different annotation packages idiosyncratic (though widely used) approach querying information.","code":"library(org.Hs.eg.db) library(GO.db) tas1 = AnnotationDbi::select(org.Hs.eg.db, keytype=\"SYMBOL\", keys=\"ORMDL3\",   columns=\"GO\") |> dplyr::filter(EVIDENCE==\"TAS\") cats = tas1$GO AnnotationDbi::select(GO.db, keytype=\"GOID\", keys = cats, columns=\"TERM\") ##         GOID                       TERM ## 1 GO:0005886            plasma membrane ## 2 GO:0030667 secretory granule membrane ## 3 GO:0035579  specific granule membrane"},{"path":[]},{"path":"https://github.com/vjcitn/BiocAnnoParq/articles/BiocAnnoParq.html","id":"queries-to-cloud-resident-parquet","dir":"Articles","previous_headings":"Introduction > BiocAnnoParq queries","what":"Queries to cloud-resident parquet","title":"BiocAnnoParq: SQL-based interrogation of Bioconductor's curated genomic annotation","text":"following, use two table references new parquet-based cloud-resident system obtain information. query_osn function sets HTTPS connection files bucket NSF Open Storage Network. “pure SQL” solution also available, R used manage connections query retrieval.","code":"library(BiocAnnoParq) con = DBI::dbConnect(duckdb::duckdb()) gi = query_osn(con, \"gene_info\") ggo = query_osn(con, \"gene2go\") otas = dplyr::left_join(gi |> dplyr::filter(symbol == \"ORMDL3\"),                          ggo |> dplyr::filter(evidence==\"TAS\"),           by=\"gene_id\") otas ## # Source:   SQL [3 x 23] ## # Database: DuckDB v1.1.3-dev165 [vincentcarey@Darwin 23.6.0:R 4.4.2/:memory:] ##   tax_id.x gene_id symbol locus_tag synonyms dbXrefs     chromosome map_location ##      <dbl>   <dbl> <chr>  <chr>     <chr>    <chr>       <chr>      <chr>        ## 1     9606   94103 ORMDL3 -         -        MIM:610075… 17         17q21.1      ## 2     9606   94103 ORMDL3 -         -        MIM:610075… 17         17q21.1      ## 3     9606   94103 ORMDL3 -         -        MIM:610075… 17         17q21.1      ## # ℹ 15 more variables: description <chr>, gene_type <chr>, ## #   nomenclature_symbol <chr>, nomenclature_name <chr>, ## #   nomenclature_status <chr>, other_designations <chr>, ## #   modification_date <chr>, feature_type <chr>, tax_id.y <dbl>, go_id <chr>, ## #   evidence <chr>, go_qualifier <chr>, go_description <chr>, pubmed_id <chr>, ## #   category <chr> DBI::dbDisconnect(con) con = DBI::dbConnect(duckdb::duckdb()) chk = DBI::dbExecute(con, \"INSTALL httpfs from core_nightly;\") chk = DBI::dbExecute(con, \"LOAD httpfs;\")      stmt = sprintf(\"CREATE VIEW gene_info as select * from parquet_scan(%s);      CREATE VIEW gene2go as select * from parquet_scan(%s);           CREATE VIEW gor as select * from gene_info where symbol = 'ORMDL3';      CREATE VIEW tas as select * from gene2go where evidence = 'TAS';      SELECT * FROM gor INNER JOIN tas ON gor.gene_id = tas.gene_id;\",      sQuote(make_parq_url(\"gene_info\")), sQuote(make_parq_url(\"gene2go\"))) z = DBI::dbSendQuery(con, stmt) DBI::dbFetch(z) ##   tax_id gene_id symbol locus_tag synonyms ## 1   9606   94103 ORMDL3         -        - ## 2   9606   94103 ORMDL3         -        - ## 3   9606   94103 ORMDL3         -        - ##                                                                        dbXrefs ## 1 MIM:610075|HGNC:HGNC:16038|Ensembl:ENSG00000172057|AllianceGenome:HGNC:16038 ## 2 MIM:610075|HGNC:HGNC:16038|Ensembl:ENSG00000172057|AllianceGenome:HGNC:16038 ## 3 MIM:610075|HGNC:HGNC:16038|Ensembl:ENSG00000172057|AllianceGenome:HGNC:16038 ##   chromosome map_location                                 description ## 1         17      17q21.1 ORMDL sphingolipid biosynthesis regulator 3 ## 2         17      17q21.1 ORMDL sphingolipid biosynthesis regulator 3 ## 3         17      17q21.1 ORMDL sphingolipid biosynthesis regulator 3 ##        gene_type nomenclature_symbol ## 1 protein-coding              ORMDL3 ## 2 protein-coding              ORMDL3 ## 3 protein-coding              ORMDL3 ##                             nomenclature_name nomenclature_status ## 1 ORMDL sphingolipid biosynthesis regulator 3                   O ## 2 ORMDL sphingolipid biosynthesis regulator 3                   O ## 3 ORMDL sphingolipid biosynthesis regulator 3                   O ##    other_designations modification_date feature_type tax_id gene_id      go_id ## 1 ORM1-like protein 3          20241102            -   9606   94103 GO:0035579 ## 2 ORM1-like protein 3          20241102            -   9606   94103 GO:0030667 ## 3 ORM1-like protein 3          20241102            -   9606   94103 GO:0005886 ##   evidence go_qualifier             go_description pubmed_id  category ## 1      TAS   located_in  specific granule membrane         - Component ## 2      TAS   located_in secretory granule membrane         - Component ## 3      TAS   located_in            plasma membrane         - Component DBI::dbClearResult(z) DBI::dbDisconnect(con)"},{"path":"https://github.com/vjcitn/BiocAnnoParq/articles/BiocAnnoParq.html","id":"queries-to-local-cache","dir":"Articles","previous_headings":"Introduction > BiocAnnoParq queries","what":"Queries to local cache","title":"BiocAnnoParq: SQL-based interrogation of Bioconductor's curated genomic annotation","text":"get_local_table retrieve parquet OSN bucket needed.","code":"library(BiocFileCache) ca = BiocFileCache() con = DBI::dbConnect(duckdb::duckdb()) gi = get_local_table(\"gene_info.parquet\", con, ca) ggo = get_local_table(\"gene2go.parquet\", con, ca) otas = dplyr::left_join(gi |> dplyr::filter(symbol == \"ORMDL3\"),                          ggo |> dplyr::filter(evidence==\"TAS\"),           by=\"gene_id\") otas ## # Source:   SQL [3 x 23] ## # Database: DuckDB v1.1.3-dev165 [vincentcarey@Darwin 23.6.0:R 4.4.2/:memory:] ##   tax_id.x gene_id symbol locus_tag synonyms dbXrefs     chromosome map_location ##      <dbl>   <dbl> <chr>  <chr>     <chr>    <chr>       <chr>      <chr>        ## 1     9606   94103 ORMDL3 -         -        MIM:610075… 17         17q21.1      ## 2     9606   94103 ORMDL3 -         -        MIM:610075… 17         17q21.1      ## 3     9606   94103 ORMDL3 -         -        MIM:610075… 17         17q21.1      ## # ℹ 15 more variables: description <chr>, gene_type <chr>, ## #   nomenclature_symbol <chr>, nomenclature_name <chr>, ## #   nomenclature_status <chr>, other_designations <chr>, ## #   modification_date <chr>, feature_type <chr>, tax_id.y <dbl>, go_id <chr>, ## #   evidence <chr>, go_qualifier <chr>, go_description <chr>, pubmed_id <chr>, ## #   category <chr> DBI::dbDisconnect(con)"},{"path":"https://github.com/vjcitn/BiocAnnoParq/articles/BiocAnnoParq.html","id":"rationale-for-the-legacy-approach","dir":"Articles","previous_headings":"","what":"Rationale for the legacy approach","title":"BiocAnnoParq: SQL-based interrogation of Bioconductor's curated genomic annotation","text":"NCBI files https://ftp.ncbi.nlm.nih.gov/gene/DATA/ 11/23/2024. humans, Bioconductor pipeline produces 8.8GB SQLite database tables: reorganized “orgDb” package","code":"gene2accession.gz               2024-11-23 02:30  3.4G   gene2ensembl.gz                 2024-11-23 02:30  239M   gene2go.gz                      2024-11-23 02:32  1.1G   gene2pubmed.gz                  2024-11-23 02:33  194M   gene2refseq.gz                  2024-11-23 02:35  1.7G   gene_group.gz                   2024-11-23 02:35  289K   gene_history.gz                 2024-11-23 02:35  139M   gene_info.gz                    2024-11-23 02:37  1.2G   gene_neighbors.gz               2024-11-23 02:39  1.5G   gene_orthologs.gz               2024-11-23 02:39   87M   gene_refseq_uniprotkb_collab.gz 2024-11-21 05:23  1.0G   go_process.dtd                  2023-09-11 09:48  1.4K   go_process.xml                  2024-07-09 16:13  8.0K   mim2gene_medgen                 2024-11-23 05:08  832K sqlite> .tables gene2accession     gene2refseq        gene_info          metadata          gene2go            gene_chromosome    gene_map_location  mim2gene          gene2pubmed        gene_dbXref        gene_synonym       refseq_uniprot"},{"path":"https://github.com/vjcitn/BiocAnnoParq/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Vince Carey. Author, maintainer.","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Carey V (2024). BiocAnnoParq: Curated genomic annotation resources cloud local use. R package version 0.0.2, https://github.com/vjcitn.","code":"@Manual{,   title = {BiocAnnoParq: Curated genomic annotation resources for cloud or local use},   author = {Vince Carey},   year = {2024},   note = {R package version 0.0.2},   url = {https://github.com/vjcitn}, }"},{"path":[]},{"path":"https://github.com/vjcitn/BiocAnnoParq/index.html","id":"sql-based-interfaces-to-bioconductors-curated-genomic-annotation","dir":"","previous_headings":"","what":"SQL-based interfaces to Bioconductor’s curated genomic annotation","title":"Curated genomic annotation resources for cloud or local use","text":"purpose package examine reliability performance impacts reformulating Bioconductor’s curation procedures general genomic annotation. AnnotationDbi idiom involves multiple packages bespoke interface using concepts keys columns. Thus identify three Gene Ontology categories gene ORMDL3 annotated traceable author statements, : package, standard query processes supported. example chunk uses standard dplyr syntax query cloud-resident parquet files: query_osn function arranges connections tables derived NCBI resources using tooling BioconductorAnnotationPipeline stack. use parquet appears produce least 10-fold reductions file size. Code complexity also reduced approach, permit queries pure SQL.","code":"library(org.Hs.eg.db) library(GO.db) tas1 = AnnotationDbi::select(org.Hs.eg.db, keytype=\"SYMBOL\", keys=\"ORMDL3\",   columns=\"GO\") |> dplyr::filter(EVIDENCE==\"TAS\") cats = tas1$GO AnnotationDbi::select(GO.db, keytype=\"GOID\", keys = cats, columns=\"TERM\") library(BiocAnnoParq) con = DBI::dbConnect(duckdb::duckdb()) gi = query_osn(con, \"gene_info\") ggo = query_osn(con, \"gene2go\") otas = dplyr::left_join(gi |> dplyr::filter(symbol == \"ORMDL3\"),                         ggo |> dplyr::filter(evidence==\"TAS\"),           by=\"gene_id\") otas"},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/available_anno_parquet.html","id":null,"dir":"Reference","previous_headings":"","what":"use 'paws::s3' to interrogate an NSF Open Storage Network bucket for zipped zarr archives for various platforms — available_anno_parquet","title":"use 'paws::s3' to interrogate an NSF Open Storage Network bucket for zipped zarr archives for various platforms — available_anno_parquet","text":"use 'paws::s3' interrogate NSF Open Storage Network bucket zipped zarr archives various platforms","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/available_anno_parquet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"use 'paws::s3' to interrogate an NSF Open Storage Network bucket for zipped zarr archives for various platforms — available_anno_parquet","text":"","code":"available_anno_parquet()"},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/available_anno_parquet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"use 'paws::s3' to interrogate an NSF Open Storage Network bucket for zipped zarr archives for various platforms — available_anno_parquet","text":"","code":"if (requireNamespace(\"paws\")) {   available_anno_parquet() } #> checking Bioconductor OSN bucket... #>  [1] \"gene2go.parquet\"            \"gene2pubmed.parquet\"        #>  [3] \"gene2refseq.parquet\"        \"gene_info.parquet\"          #>  [5] \"gene_synonym.parquet\"       \"mim2gene.parquet\"           #>  [7] \"mouse.gene2go.parquet\"      \"mouse.gene2pubmed.parquet\"  #>  [9] \"mouse.gene2refseq.parquet\"  \"mouse.gene_info.parquet\"    #> [11] \"mouse.gene_synonym.parquet\" \"mouse.mim2gene.parquet\""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/get_local_table.html","id":null,"dir":"Reference","previous_headings":"","what":"obtain path to a localized parquet resource — get_local_table","title":"obtain path to a localized parquet resource — get_local_table","text":"obtain path localized parquet resource","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/get_local_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"obtain path to a localized parquet resource — get_local_table","text":"","code":"get_local_table(x, con, cache = BiocFileCache::BiocFileCache())"},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/get_local_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"obtain path to a localized parquet resource — get_local_table","text":"x character(1) stub use make_parq_url con DBI connection cache BiocFileCache-compliant cache","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/get_local_table.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"obtain path to a localized parquet resource — get_local_table","text":"cache already relevant file, one retrieved Bioconductor OSN bucket.","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/get_local_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"obtain path to a localized parquet resource — get_local_table","text":"","code":"ca = BiocFileCache::BiocFileCache() con = DBI::dbConnect(duckdb::duckdb()) pa = get_local_table(\"gene_info.parquet\", con, ca) #> returning path to cached parquet pa #> # Source:   table<gene_info> [?? x 16] #> # Database: DuckDB v1.1.3-dev165 [vincentcarey@Darwin 23.6.0:R 4.4.2/:memory:] #>    tax_id gene_id symbol   locus_tag synonyms    dbXrefs chromosome map_location #>     <dbl>   <dbl> <chr>    <chr>     <chr>       <chr>   <chr>      <chr>        #>  1   9606       1 A1BG     -         A1B|ABG|GA… MIM:13… 19         19q13.43     #>  2   9606       2 A2M      -         A2MD|CPAMD… MIM:10… 12         12p13.31     #>  3   9606       3 A2MP1    -         A2MP        HGNC:H… 12         12p13.31     #>  4   9606       9 NAT1     -         AAC1|MNAT|… MIM:10… 8          8p22         #>  5   9606      10 NAT2     -         AAC2|NAT-2… MIM:61… 8          8p22         #>  6   9606      11 NATP     -         AACP|NATP1  HGNC:H… 8          8p22         #>  7   9606      12 SERPINA3 -         AACT|ACT|G… MIM:10… 14         14q32.13     #>  8   9606      13 AADAC    -         CES5A1|DAC  MIM:60… 3          3q25.1       #>  9   9606      14 AAMP     -         -           MIM:60… 2          2q35         #> 10   9606      15 AANAT    -         DSPS|SNAT   MIM:60… 17         17q25.1      #> # ℹ more rows #> # ℹ 8 more variables: description <chr>, gene_type <chr>, #> #   nomenclature_symbol <chr>, nomenclature_name <chr>, #> #   nomenclature_status <chr>, other_designations <chr>, #> #   modification_date <chr>, feature_type <chr>"},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/make_parq_url.html","id":null,"dir":"Reference","previous_headings":"","what":"support for URL generation based on NSF OSN bucket — make_parq_url","title":"support for URL generation based on NSF OSN bucket — make_parq_url","text":"support URL generation based NSF OSN bucket","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/make_parq_url.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"support for URL generation based on NSF OSN bucket — make_parq_url","text":"","code":"make_parq_url(stub)"},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/make_parq_url.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"support for URL generation based on NSF OSN bucket — make_parq_url","text":"stub character(1) string like gene2go","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/query_osn.html","id":null,"dir":"Reference","previous_headings":"","what":"produce a tbl with genomic annotation using a remote parquet file — query_osn","title":"produce a tbl with genomic annotation using a remote parquet file — query_osn","text":"produce tbl genomic annotation using remote parquet file","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/query_osn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"produce a tbl with genomic annotation using a remote parquet file — query_osn","text":"","code":"query_osn(con, stub = \"gene_info\")"},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/query_osn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"produce a tbl with genomic annotation using a remote parquet file — query_osn","text":"con DBI connection, typically using duckdb, can used query remote parquet files stub character(1) tag identifying annotation resource","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/query_osn.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"produce a tbl with genomic annotation using a remote parquet file — query_osn","text":"DBI::dbListTables used query connection existence desired table/view, returned present.  Otherwise httpfs based query used produce view.","code":""},{"path":"https://github.com/vjcitn/BiocAnnoParq/reference/query_osn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"produce a tbl with genomic annotation using a remote parquet file — query_osn","text":"","code":"con = DBI::dbConnect(duckdb::duckdb()) query_osn(con, stub=\"gene_info\") #> # Source:   table<gene_info> [?? x 16] #> # Database: DuckDB v1.1.3-dev165 [vincentcarey@Darwin 23.6.0:R 4.4.2/:memory:] #>    tax_id gene_id symbol   locus_tag synonyms    dbXrefs chromosome map_location #>     <dbl>   <dbl> <chr>    <chr>     <chr>       <chr>   <chr>      <chr>        #>  1   9606       1 A1BG     -         A1B|ABG|GA… MIM:13… 19         19q13.43     #>  2   9606       2 A2M      -         A2MD|CPAMD… MIM:10… 12         12p13.31     #>  3   9606       3 A2MP1    -         A2MP        HGNC:H… 12         12p13.31     #>  4   9606       9 NAT1     -         AAC1|MNAT|… MIM:10… 8          8p22         #>  5   9606      10 NAT2     -         AAC2|NAT-2… MIM:61… 8          8p22         #>  6   9606      11 NATP     -         AACP|NATP1  HGNC:H… 8          8p22         #>  7   9606      12 SERPINA3 -         AACT|ACT|G… MIM:10… 14         14q32.13     #>  8   9606      13 AADAC    -         CES5A1|DAC  MIM:60… 3          3q25.1       #>  9   9606      14 AAMP     -         -           MIM:60… 2          2q35         #> 10   9606      15 AANAT    -         DSPS|SNAT   MIM:60… 17         17q25.1      #> # ℹ more rows #> # ℹ 8 more variables: description <chr>, gene_type <chr>, #> #   nomenclature_symbol <chr>, nomenclature_name <chr>, #> #   nomenclature_status <chr>, other_designations <chr>, #> #   modification_date <chr>, feature_type <chr> query_osn(con, stub=\"gene2go\") #> # Source:   table<gene2go> [?? x 8] #> # Database: DuckDB v1.1.3-dev165 [vincentcarey@Darwin 23.6.0:R 4.4.2/:memory:] #>    tax_id gene_id go_id  evidence go_qualifier go_description pubmed_id category #>     <dbl>   <dbl> <chr>  <chr>    <chr>        <chr>          <chr>     <chr>    #>  1   9606       1 GO:00… IBA      involved_in  immune respon… -         Process  #>  2   9606       1 GO:00… HDA      located_in   extracellular… 27068509  Compone… #>  3   9606       1 GO:00… IDA      located_in   extracellular… 3458201   Compone… #>  4   9606       1 GO:00… TAS      located_in   extracellular… -         Compone… #>  5   9606       1 GO:00… HDA      located_in   extracellular… 16502470  Compone… #>  6   9606       1 GO:00… IBA      is_active_in plasma membra… -         Compone… #>  7   9606       1 GO:00… TAS      located_in   platelet alph… -         Compone… #>  8   9606       1 GO:00… TAS      located_in   secretory gra… -         Compone… #>  9   9606       1 GO:00… HDA      located_in   collagen-cont… 27559042  Compone… #> 10   9606       1 GO:00… HDA      located_in   extracellular… 19056867… Compone… #> # ℹ more rows DBI::dbDisconnect(con)"}]
